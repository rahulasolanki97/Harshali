<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Expense Tracker</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: Arial, sans-serif; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh; 
            display: flex; 
            justify-content: center; 
            align-items: center;
            padding: 20px;
        }
        .container { width: 100%; max-width: 400px; }
        .form-box { 
            background: white; 
            padding: 40px; 
            border-radius: 10px; 
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }
        h1 { text-align: center; color: #333; margin-bottom: 30px; }
        .form-group { margin-bottom: 20px; }
        label { display: block; margin-bottom: 5px; color: #333; font-weight: bold; }
        input { 
            width: 100%; 
            padding: 10px; 
            border: 2px solid #ddd; 
            border-radius: 5px; 
            font-size: 14px;
        }
        input:focus { outline: none; border-color: #2563eb; }
        button { 
            width: 100%; 
            padding: 12px; 
            background: #2563eb; 
            color: white; 
            border: none; 
            border-radius: 5px; 
            font-weight: bold; 
            cursor: pointer;
            margin-top: 10px;
        }
        button:hover { background: #1d4ed8; }
        .toggle-link { text-align: center; margin-top: 20px; }
        .toggle-link a { color: #2563eb; cursor: pointer; text-decoration: underline; }
        .error { color: #ef4444; padding: 10px; background: #fef2f2; border-radius: 5px; margin-bottom: 20px; display: none; }
        .success { color: #16a34a; padding: 10px; background: #f0fdf4; border-radius: 5px; margin-bottom: 20px; display: none; }
        .hidden { display: none !important; }
        .dashboard { background: white; border-radius: 10px; padding: 30px; box-shadow: 0 10px 25px rgba(0,0,0,0.2); }
        .dashboard h2 { color: #333; margin-bottom: 20px; }
        .user-section { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .balance { font-size: 24px; color: #2563eb; font-weight: bold; margin-bottom: 20px; }
        .logout-btn { width: 150px; background: #ef4444; margin-top: 0; }
        .transaction-list { margin-top: 20px; max-height: 300px; overflow-y: auto; }
        .transaction-item { 
            padding: 10px; 
            background: #f8f9fa; 
            margin-bottom: 10px; 
            border-radius: 5px; 
            display: flex; 
            justify-content: space-between;
        }
        .delete-btn { width: auto; padding: 5px 10px; background: #ef4444; font-size: 12px; margin-top: 0; }
    </style>
</head>
<body>
    <div class="container">
        <!-- LOGIN FORM -->
        <div id="loginSection" class="form-box">
            <h1>ðŸ’° Login</h1>
            <div class="error" id="loginError"></div>
            <div class="success" id="loginSuccess"></div>
            <div class="form-group">
                <label>Username</label>
                <input type="text" id="loginUser" placeholder="Enter username">
            </div>
            <div class="form-group">
                <label>Password</label>
                <input type="password" id="loginPass" placeholder="Enter password">
            </div>
            <button onclick="handleLogin()">Login</button>
            <div class="toggle-link">
                Don't have an account? <a onclick="switchToSignup()">Sign Up</a>
            </div>
        </div>

        <!-- SIGNUP FORM -->
        <div id="signupSection" class="form-box hidden">
            <h1>ðŸ’° Sign Up</h1>
            <div class="error" id="signupError"></div>
            <div class="success" id="signupSuccess"></div>
            <div class="form-group">
                <label>Username</label>
                <input type="text" id="signupUser" placeholder="Choose username">
            </div>
            <div class="form-group">
                <label>Password (min 6 chars)</label>
                <input type="password" id="signupPass" placeholder="Choose password">
            </div>
            <div class="form-group">
                <label>Confirm Password</label>
                <input type="password" id="signupConfirm" placeholder="Confirm password">
            </div>
            <button onclick="handleSignup()">Sign Up</button>
            <div class="toggle-link">
                Already have an account? <a onclick="switchToLogin()">Login</a>
            </div>
        </div>

        <!-- DASHBOARD -->
        <div id="dashboardSection" class="dashboard hidden">
            <div class="user-section">
                <h2>Welcome, <span id="displayUser"></span>!</h2>
                <button class="logout-btn" onclick="handleLogout()">Logout</button>
            </div>
            <div class="balance">Balance: â‚¹<span id="displayBalance">0.00</span></div>
            
            <div class="form-group">
                <label>Description</label>
                <input type="text" id="description" placeholder="What is this for?">
            </div>
            <div class="form-group">
                <label>Amount</label>
                <input type="number" id="amount" placeholder="0.00" step="0.01">
            </div>
            <button onclick="addIncome()">âž• Add Income</button>
            <button onclick="addExpense()" style="background: #ef4444;">âž– Add Expense</button>

            <div class="transaction-list">
                <div id="transactionContainer"></div>
            </div>
        </div>
    </div>

    <script>
        // Initialize App
        function initApp() {
            const saved = localStorage.getItem('appData');
            if (saved) {
                const data = JSON.parse(saved);
                window.users = data.users || {};
                window.currentUser = data.currentUser;
            } else {
                window.users = {};
                window.currentUser = null;
            }
            
            if (window.currentUser) {
                const user = window.users[window.currentUser];
                window.transactions = user.transactions || [];
                window.balance = user.balance || 0;
                showDashboard();
            }
        }

        function saveData() {
            localStorage.setItem('appData', JSON.stringify({
                users: window.users,
                currentUser: window.currentUser
            }));
        }

        function switchToSignup() {
            document.getElementById('loginSection').classList.add('hidden');
            document.getElementById('signupSection').classList.remove('hidden');
        }

        function switchToLogin() {
            document.getElementById('signupSection').classList.add('hidden');
            document.getElementById('loginSection').classList.remove('hidden');
        }

        function showError(elementId, message) {
            const el = document.getElementById(elementId);
            el.textContent = message;
            el.style.display = 'block';
            setTimeout(() => { el.style.display = 'none'; }, 5000);
        }

        function handleSignup() {
            const username = document.getElementById('signupUser').value.trim();
            const password = document.getElementById('signupPass').value;
            const confirm = document.getElementById('signupConfirm').value;

            if (!username || !password) {
                showError('signupError', 'Fill in all fields');
                return;
            }
            if (username.length < 3) {
                showError('signupError', 'Username must be 3+ characters');
                return;
            }
            if (password.length < 6) {
                showError('signupError', 'Password must be 6+ characters');
                return;
            }
            if (password !== confirm) {
                showError('signupError', 'Passwords do not match');
                return;
            }
            if (window.users[username]) {
                showError('signupError', 'Username already exists');
                return;
            }

            window.users[username] = { password, transactions: [], balance: 0 };
            saveData();
            
            document.getElementById('signupSuccess').textContent = 'Account created! Login now.';
            document.getElementById('signupSuccess').style.display = 'block';
            
            document.getElementById('signupUser').value = '';
            document.getElementById('signupPass').value = '';
            document.getElementById('signupConfirm').value = '';
            
            setTimeout(() => switchToLogin(), 2000);
        }

        function handleLogin() {
            const username = document.getElementById('loginUser').value.trim();
            const password = document.getElementById('loginPass').value;

            if (!username || !password) {
                showError('loginError', 'Fill in all fields');
                return;
            }

            const user = window.users[username];
            if (!user || user.password !== password) {
                showError('loginError', 'Invalid username or password');
                return;
            }

            window.currentUser = username;
            window.transactions = user.transactions || [];
            window.balance = user.balance || 0;
            saveData();

            document.getElementById('loginUser').value = '';
            document.getElementById('loginPass').value = '';
            
            showDashboard();
        }

        function showDashboard() {
            document.getElementById('loginSection').classList.add('hidden');
            document.getElementById('signupSection').classList.add('hidden');
            document.getElementById('dashboardSection').classList.remove('hidden');
            document.getElementById('displayUser').textContent = window.currentUser;
            updateBalance();
            showTransactions();
        }

        function handleLogout() {
            if (confirm('Logout?')) {
                window.currentUser = null;
                saveData();
                document.getElementById('dashboardSection').classList.add('hidden');
                document.getElementById('loginSection').classList.remove('hidden');
                document.getElementById('loginUser').value = '';
                document.getElementById('loginPass').value = '';
            }
        }

        function addIncome() {
            const desc = document.getElementById('description').value.trim();
            const amt = parseFloat(document.getElementById('amount').value);

            if (!desc || !amt || amt <= 0) {
                alert('Enter valid description and amount');
                return;
            }

            window.balance += amt;
            window.transactions.push({ 
                type: 'income', 
                description: desc, 
                amount: amt, 
                date: new Date().toLocaleDateString() 
            });
            
            window.users[window.currentUser].balance = window.balance;
            window.users[window.currentUser].transactions = window.transactions;
            saveData();

            document.getElementById('description').value = '';
            document.getElementById('amount').value = '';
            updateBalance();
            showTransactions();
        }

        function addExpense() {
            const desc = document.getElementById('description').value.trim();
            const amt = parseFloat(document.getElementById('amount').value);

            if (!desc || !amt || amt <= 0) {
                alert('Enter valid description and amount');
                return;
            }

            window.balance -= amt;
            window.transactions.push({ 
                type: 'expense', 
                description: desc, 
                amount: amt, 
                date: new Date().toLocaleDateString() 
            });
            
            window.users[window.currentUser].balance = window.balance;
            window.users[window.currentUser].transactions = window.transactions;
            saveData();

            document.getElementById('description').value = '';
            document.getElementById('amount').value = '';
            updateBalance();
            showTransactions();
        }

        function updateBalance() {
            document.getElementById('displayBalance').textContent = window.balance.toFixed(2);
        }

        function showTransactions() {
            const container = document.getElementById('transactionContainer');
            if (window.transactions.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #999;">No transactions yet</p>';
                return;
            }

            container.innerHTML = window.transactions.map((t, i) => `
                <div class="transaction-item">
                    <div>
                        <strong>${t.description}</strong><br>
                        <small style="color: #666;">${t.date}</small>
                    </div>
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <span style="color: ${t.type === 'income' ? '#16a34a' : '#ef4444'}; font-weight: bold;">
                            ${t.type === 'income' ? '+' : '-'}â‚¹${t.amount.toFixed(2)}
                        </span>
                        <button class="delete-btn" onclick="deleteTransaction(${i})">Delete</button>
                    </div>
                </div>
            `).join('');
        }

        function deleteTransaction(index) {
            const t = window.transactions[index];
            if (t.type === 'income') {
                window.balance -= t.amount;
            } else {
                window.balance += t.amount;
            }
            window.transactions.splice(index, 1);
            window.users[window.currentUser].balance = window.balance;
            window.users[window.currentUser].transactions = window.transactions;
            saveData();
            updateBalance();
            showTransactions();
        }

        // Start app when page loads
        window.addEventListener('load', initApp);
    </script>
</body>
</html>
